# 군집화 모델 - 마케팅

```python
#Step 1 : 라이브러리 가져오기
import pandas as pd
#Step 2 : 데이터 읽기 및 정보 파악
df = pd.read_csv('data/Mall_Customers.csv')
df.head()
#데이터 정보 파악
df.shape
df.info()
df.columns
#데이터 처리
df.isnull().sum()
#Step 3 : 기계학습 데이터 준비
x = df[['Annual_Income','Spending_Score']]
x.head()
```
```python
#기계학습 군집화 모델 구현
#Step 1 : 라이브러리 가져오기
from sklearn.cluster import KMeans
import matplotlib.pyplot as plt
from sklearn.metrics import silhouette_samples, silhouette_score
#Step 2 : 모델 객체 생성
k = 5
model_km = KMeans(n_clusters=k)
#Step 3 : 모델 학습
#X데이터 프레임에 대해 모델 학습
model_km.fit(X)
#각 클러스터의 중심점 확인
model_km.cluster_centers_
model_km.labes_
#각 군집의 데이터 수를 확인한다
pd.Series(model_km.labes_).value_counts()
#Step 4 : 모델 예측
#데이터(X)로 ㅅ고하느 그룹을 예측하기(predict())
plt.figure()
plt.title( 'Clustering of Customers, k=' + str(k) )
plt.xlabel( X.columns[0])   # Annual_Income
plt.ylabel( X.columns[1])   # Spending_Score
  
colors = ['C0','C1','C2','C3','C4','C5','C6','C7','C8','C9']

for i in range(k) :
    plt.scatter( X.iloc[model_km.labels_==i, 0],
                 X.iloc[model_km.labels_==i, 1],
                 c = colors[i%10],  label = 'Cluster '+ str(i) )

plt.scatter( model_km.cluster_centers_[:, 0],
             model_km.cluster_centers_[:, 1],
             c='black', marker='*', s=200, label='Centroids' )

plt.legend()
plt.show()

```
![[Pasted image 20250424093508.png]]
```python
print (model_km.predict( pd.DataFrame( {'Annual_Income'  : [85],
                                         'Spending_Score' : [65]} )))
plt.figure()

  
plt.title( 'Clustering of Customers, k=' + str(k) )
plt.xlabel( X.columns[0])   # Annual_Income
plt.ylabel( X.columns[1])   # Spending_Score

colors = ['C0','C1','C2','C3','C4','C5','C6','C7','C8','C9']

for i in range(k) :
    plt.scatter( X.iloc[model_km.labels_==i, 0],
                 X.iloc[model_km.labels_==i, 1],
                 c = colors[i%10],  label = 'Cluster '+ str(i) )

plt.scatter( model_km.cluster_centers_[:, 0],
             model_km.cluster_centers_[:, 1],
             c='black', marker='*', s=200, label='Centroids' )

  

# Annual_Income: 85, Spending_Score : 65
plt.scatter(85, 65, c = 'red', marker='X', s=200, label='Test')
plt.legend()
plt.show()
```
```python
#Step 5 : 평가하기
from sklearn.metrics import silhouette_samples, silhouette_score
silhouette_score(X, model_km.labels_)
silhouette_samples(X, model_km.labels_)

df_result = X.copy()
df_result['Cluster_no'] = model_km.labels_
df_result['S_score'] = silhouette_samples(X, model_km.labels_)
df_result.head()

```
# 딥러닝(DNN)
PyTorch
TensorFlow
Keras

### Keras
> [!NOTE] 딥러닝 학습하기 프로세스
	1) 모듈 포함하기 - keras, matplotlib,cv2
	2) 데이터셋 생성 - 훈련셋(train_image),시험셋(test_image)
	3) 신경망 모델 구성 - 모델 층 만들기 : Sequential()함수
	4) 모델 학습 과정 설정 - 신경망 최적화하기, 손실함수 정의 : compile()함수
	5) 모델 학습 - fit()함수
	6) 학습 과정 살펴보기 - 손실(loss), 정확도(accuracy)/matplotlib의 pyplot
	7) 모델 평가 및 예측
	
